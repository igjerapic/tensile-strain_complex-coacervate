###################################
### GENERAL SETTINGS FOR THE LAMMPS SCRIPT FOR COMPRESSING AND STRETCHING 
### A COMPLEX COACERVATE
###################################

###################################
####  GROUPS
####################################

group  pos_chains  type 1
group  neg_chains  type 2

####################################
####  POTENTIALS
####################################

bond_style    fene
bond_coeff    1 30.0 1.5 1.0 1.0  # taken from doi:10.1021/acsmacrolett.5c00323 

# have different coeffs for substrate atoms? 
bond_coeff    2 0.0 1.5 1.0 1.0 
special_bonds lj 0.0 1.0 1.0 coul 1.0 1.0 1.0 # taken from Nayan's coacervate paper

dielectric 10.0 # weak coloumbic interaction to avoid like charges being close

pair_style lj/cut/coul/cut 1.12246 10.0
pair_coeff * * 1.0 1.0 1.12246 10.0

set group pos_chains charge 1.0 
set group neg_chains charge -1.0

####################################
####  VARIABLES DEFINITION
####################################
variable Temp equal 1.5
variable Temp2 equal 1.0
variable PressAnn equal 10.0
variable PressEq equal 0.0
variable dt equal 0.005
variable Tdamping equal 10*${dt}
variable Pdamping equal 100*${dt}
variable runtime equal 100000
variable runtimeShort equal 50000

# final thickness calculation      
#TODO make Lbox, target_density, and tot_chainVol inputted 
variable thickFinal equal 8.0 # want a final thickness of 16 
variable target_density equal 0.8 

variable n_atoms equal atoms
variable Lbox equal (${n_atoms}/(${target_density}*2*${thickFinal}))^0.5/2 # half of total thickness
variable thick1 equal ${thickFinal}+4.0

variable thermoT equal 100
variable velSeed equal 934851

####################################
#### THERMO-STYLE
####################################

thermo  ${thermoT}

compute	stressA all stress/atom NULL
compute	p all reduce sum c_stressA[1] c_stressA[2] c_stressA[3]
variable	pz equal -(c_p[3])/(vol)
variable	pxy equal -(c_p[1]+c_p[2])/(2*vol)
thermo_style	custom step temp time ebond epair ke etotal enthalpy vol density press v_pxy v_pz spcpu cpuremain 
thermo_modify line yaml format none

####################################
#### INTEGRATION
####################################
timestep      ${dt}
